@{
    ViewData["Title"] = "Diff Checker";
}

<div class="container">
    <div class="tool-header">
        <h1 class="tool-title">Diff Checker</h1>
        <p class="tool-description">Paste two texts below and check their differences!</p>
    </div>

    <div class="form-group">
        <label for="textA" class="form-label">Text A:</label>
        <textarea id="textA" class="form-control" rows="8"></textarea>
    </div>

    <div class="form-group">
        <label for="textB" class="form-label">Text B:</label>
        <textarea id="textB" class="form-control" rows="8"></textarea>
    </div>

    <div class="form-group">
        <button class="btn btn-primary" onclick="compareTexts()">Compare</button>
    </div>

    <div id="diffResultContainer" style="display: none;">
        <label class="form-label">Differences:</label>
        <div id="diffResult" class="p-3" style="white-space: pre-wrap; border: 1px solid #ccc; font-family: monospace;"></div>
    </div>

    <div id="alertContainer"></div>
</div>

@section Scripts {
    <script src="https://unpkg.com/diff-match-patch/index.js"></script>
    <script>
        function diffWords(a, b) {
            const dmp = new diff_match_patch();
            const diff = dmp.diff_main(a, b);
            dmp.diff_cleanupSemantic(diff);

            const result = diff.map(([op, data]) => {
                if (op === 0) {
                    return `<span>${data}</span>`;
                } else if (op === -1) {
                    return `<span style="background-color:#ffe0e0; color: red;">- ${data}</span>`;
                } else if (op === 1) {
                    return `<span style="background-color:#d0ffd0; color: green;">+ ${data}</span>`;
                }
            }).join(' ');

            return result;
        }

        function compareTexts() {
            const textA = document.getElementById('textA').value.trim();
            const textB = document.getElementById('textB').value.trim();

            if (!textA || !textB) {
                showAlert("Both texts must be filled!");
                return;
            }

            const result = diffWords(textA, textB);
            document.getElementById('diffResult').innerHTML = result;
            document.getElementById('diffResultContainer').style.display = 'block';
        }
    </script>

}
